{%- extends "profile/profile_base.html" -%}
{%- import "profile/profile_macros.html" as profile_macro -%}
{% block profile_title %}
  {%- if user.email -%}
    {% trans user_email=user.email %}Profile for {{ user_email }}{% endtrans %}
  {%- else -%}
    {% trans user_id=user.id %}Profile for #{{ user_id }}{% endtrans %}
  {%- endif -%}
{% endblock %}
{% block profile_content %}
    <!--
        profile view for user via admin page
        vieweable only by admin staff
    -->
    {{profile_macro.profileDemo(user, current_user)}}
    {%-if user and user.has_role(ROLE.PATIENT) %}
        {{profile_macro.profileDemoDetail(user, current_user)}}
    {%- endif %}
    {{profile_macro.profileCommunications(user, current_user)}}

    <div class="row">
        <div class="col-md-12 col-xs-12">
            <div class="profile-item-container editable" data-sections="org">
                <h4 id="orgsLoc" class="profile-item-title index-item">{{ _("Clinic") }}</h4>
                {{profile_macro.profileOrg(user,None,consent_agreements, current_user)}}
            </div>
        </div>
    </div>
    {%- if user and (user.has_role(ROLE.PATIENT) or user.has_role(ROLE.PARTNER))%}
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class="profile-item-container">
                    <h4 id="consentHistoryLoc" class="profile-item-title index-item">{% if config.CONSENT_WITH_TOP_LEVEL_ORG %}{{_("Agreement to Share Clinical Information")}} {%else%}{{ _("Consent History") }} {%endif%}</h4>
                    {{profile_macro.profileConsent(user, current_user)}}
                </div>
            </div>
        </div>
    {%- endif %}

    {%- if user and (user.has_role(ROLE.PATIENT)) and current_user and current_user.has_role(ROLE.INTERVENTION_STAFF) %}
        {{profile_macro.profileInterventions(user_interventions) | show_macro('interventions')}}
    {%- endif %}

    {%- if user and user.has_role(ROLE.PATIENT)%}
        <div class="row" id="profileSessionListMainContainer">
            <div class="col-md-12 col-xs-12">
                <div  class="profile-item-container">
                     <h4 id="proAssessmentsLoc" class="profile-item-title index-item">{% if current_user and current_user.has_role(ROLE.PATIENT) %}{{ _("My Questionnaires") }}{% else %}{{ _("PRO Questionnaires") }}{% endif %}</h4>
                    {{profile_macro.profileSessionList(user, current_user)}}
                </div>
            </div>
        </div>
    {%- endif %}

    {%- if user and user.has_role(ROLE.PATIENT) %}
        {{profile_macro.profileClinicalQuestions(user, current_user) | show_macro('clinical_questions')}}
    {%- endif %}

    {%- if user and user.has_role(ROLE.PATIENT) %}
        {{profile_macro.profileProcedures(user, current_user) | show_macro('procedures')}}
    {%- endif %}

    {%- if user and user.has_role(ROLE.PATIENT) %}
        {{profile_macro.profileInterventionReports(user) | show_macro('intervention_reports')}}
    {%- endif %}

    {%- if (user and current_user) and user.has_role(ROLE.PATIENT) %}
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class="profile-item-container">
                    <h4 id="patientReportsLoc" class="profile-item-title index-item">{{ _("Patient Reports") }}</h4>
                    {{profile_macro.patientReports(user)}}
                </div>
            </div>
        </div>
    {%- endif %}
    {%- if (user and current_user) and user.has_role(ROLE.PATIENT) %}
        {{profile_macro.profileDeceased(user, current_user)}}
    {%- endif %}
    <div class="row">
        <div class="col-md-12 col-xs-12">{{profile_macro.profileLocaleTimeZone(user)}}</div>
    </div>
    {%- if (user and current_user) and current_user.has_role(ROLE.ADMIN) and not user.has_role(ROLE.SERVICE) %}
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class="profile-item-container">
                     <h4 id="rolesLoc" class="profile-item-title index-item">{{ _("User Roles") }}</h4>{{profile_macro.profileRole(user, current_user)}}
                </div>
            </div>
        </div>
    {%- endif %}

    {%- if (user and current_user) and (current_user.has_role(ROLE.ADMIN) or current_user.has_role(ROLE.STAFF) or current_user.has_role(ROLE.INTERVENTION_STAFF)) %}
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class="profile-item-container">
                    <h4 id="auditLogLoc" class="profile-item-title index-item">{{ _("Audit Log") }}</h4>
                    {{profile_macro.profileAuditLog(user, current_user)}}
                </div>
            </div>
        </div>
    {%- endif %}
{% endblock %}
{% block document_ready %}
    {{super()}}
{% endblock %}
